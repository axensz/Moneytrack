/**
 * Estilos de accesibilidad y utilidades globales
 * Focus visible, scrollbar, screen readers
 */

/* Clase para elementos solo visibles para screen readers */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Safe area para dispositivos con notch */
.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

/* Focus visible mejorado para accesibilidad */
*:focus-visible {
  outline: 2px solid theme('colors.purple.500');
  outline-offset: 2px;
  border-radius: 4px;
}

.dark *:focus-visible {
  outline-color: theme('colors.purple.400');
}

/* Custom scrollbar for transaction lists */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: rgba(139, 92, 246, 0.3) transparent;
}

.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: rgba(139, 92, 246, 0.3);
  border-radius: 3px;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: rgba(139, 92, 246, 0.5);
}

.dark .scrollbar-thin {
  scrollbar-color: rgba(167, 139, 250, 0.3) transparent;
}

.dark .scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: rgba(167, 139, 250, 0.3);
}

.dark .scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: rgba(167, 139, 250, 0.5);
}

/* Prevenir zoom en inputs en iOS */
@media screen and (max-width: 640px) {

  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  select,
  textarea {
    font-size: 16px !important;
  }
}

/* ─── Responsive Typography ─────────────────────────── */

/* Base font sizes - mobile first */
body {
  font-size: 14px;
  line-height: 1.6;
  /* Improved readability */
}

@media (min-width: 640px) {
  body {
    font-size: 16px;
  }
}

/* Headings responsive scaling */
h1 {
  font-size: 1.75rem;
  /* 28px on mobile */
  line-height: 1.3;
  font-weight: 700;
}

@media (min-width: 640px) {
  h1 {
    font-size: 2.25rem;
    /* 36px on desktop */
  }
}

h2 {
  font-size: 1.5rem;
  /* 24px on mobile */
  line-height: 1.4;
  font-weight: 600;
}

@media (min-width: 640px) {
  h2 {
    font-size: 1.875rem;
    /* 30px on desktop */
  }
}

h3 {
  font-size: 1.25rem;
  /* 20px on mobile */
  line-height: 1.5;
  font-weight: 600;
}

@media (min-width: 640px) {
  h3 {
    font-size: 1.5rem;
    /* 24px on desktop */
  }
}

/* Text truncation utilities */
.truncate-1 {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.truncate-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.truncate-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Ensure proper line height for readability */
p,
li,
span {
  line-height: 1.6;
  letter-spacing: 0.01em;
}

/* Small text should maintain readability */
.text-xs {
  font-size: 0.75rem;
  line-height: 1.5;
}

.text-sm {
  font-size: 0.875rem;
  line-height: 1.5;
}

/* Responsive text utilities */
.text-responsive-sm {
  font-size: 0.875rem;
}

@media (min-width: 640px) {
  .text-responsive-sm {
    font-size: 1rem;
  }
}

.text-responsive-base {
  font-size: 1rem;
}

@media (min-width: 640px) {
  .text-responsive-base {
    font-size: 1.125rem;
  }
}

.text-responsive-lg {
  font-size: 1.125rem;
}

@media (min-width: 640px) {
  .text-responsive-lg {
    font-size: 1.25rem;
  }
}

/* Mejorar el comportamiento de scroll en móviles */
@media (max-width: 640px) {
  body {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: none;
  }
}

/* Asegurar que los modales y overlays cubran toda la pantalla en móviles */
@media (max-width: 640px) {
  .fixed.inset-0 {
    height: 100vh;
    height: 100dvh;
    /* Dynamic viewport height para navegadores modernos */
  }
}

/* Ajustes específicos para el chat en móviles */
@media (max-width: 640px) {

  /* Asegurar que el chat no se solape con la navegación inferior */
  .chat-container {
    max-height: calc(100vh - 180px);
    max-height: calc(100dvh - 180px);
  }

  /* Mejorar el scroll dentro del chat */
  .chat-messages {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

/* Mejoras para tablets y pantallas medianas */
@media (min-width: 641px) and (max-width: 1024px) {

  .card-stat,
  .card-balance,
  .card {
    padding: 1rem;
  }
}

/* Mejoras para pantallas grandes */
@media (min-width: 1025px) {

  .card-stat,
  .card-balance,
  .card {
    padding: 1.25rem;
  }
}

/* Asegurar que los botones tengan un tamaño mínimo táctil en móviles */
@media (max-width: 640px) {
  button:not(.btn-type):not(.text-xs) {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Animación shimmer para el header del chat */
@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }

  100% {
    transform: translateX(100%);
  }
}

.animate-shimmer {
  animation: shimmer 3s infinite;
}

/* ─── Dropdown Viewport Containment ─────────────────── */

/* Ensure dropdowns stay within viewport bounds */
.dropdown-container {
  position: relative;
}

.dropdown-menu {
  position: absolute;
  z-index: 50;
  min-width: 200px;
  max-width: calc(100vw - 2rem);
  /* Prevent overflow on mobile */
  max-height: 300px;
  overflow-y: auto;
  background-color: var(--card);
  border: 1px solid var(--border);
  border-radius: 0.75rem;
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

/* Smart positioning: flip if near bottom of viewport */
.dropdown-menu[data-position="bottom"] {
  top: 100%;
  margin-top: 0.5rem;
}

.dropdown-menu[data-position="top"] {
  bottom: 100%;
  margin-bottom: 0.5rem;
}

/* Align to right if near right edge */
.dropdown-menu[data-align="right"] {
  right: 0;
}

.dropdown-menu[data-align="left"] {
  left: 0;
}

/* Mobile-specific dropdown styles */
@media (max-width: 640px) {
  .dropdown-menu {
    max-width: calc(100vw - 1rem);
    max-height: 50vh;
    /* Limit height on mobile */
  }

  /* Full-width dropdowns on mobile for better touch targets */
  .dropdown-menu-mobile-full {
    left: 0.5rem;
    right: 0.5rem;
    width: calc(100vw - 1rem);
  }
}

/* Animaciones de entrada mejoradas */
@keyframes slide-in-from-bottom-2 {
  from {
    opacity: 0;
    transform: translateY(8px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slide-in-from-bottom-4 {
  from {
    opacity: 0;
    transform: translateY(16px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes zoom-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-in {
  animation-fill-mode: both;
}

.fade-in {
  animation-name: fadeIn;
}

.slide-in-from-bottom-2 {
  animation-name: slide-in-from-bottom-2;
}

.slide-in-from-bottom-4 {
  animation-name: slide-in-from-bottom-4;
}

.zoom-in {
  animation-name: zoom-in;
}

.duration-300 {
  animation-duration: 300ms;
}

.duration-500 {
  animation-duration: 500ms;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}