@import "tailwindcss";

/* 1. Variante para detectar modo oscuro manualmente */
@variant dark (&:where(.dark, .dark *));

/* 2. Definición del Tema con Variables Nativas */
@theme {
  /* Colores Semánticos */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  
  --color-success: var(--success);
  --color-success-muted: var(--success-muted);
  
  --color-destructive: var(--destructive);
  --color-destructive-muted: var(--destructive-muted);
  
  --color-warning: var(--warning);
  --color-warning-muted: var(--warning-muted);
  
  --color-info: var(--info);
  --color-info-muted: var(--info-muted);
  
  --color-balance-accent: var(--balance-accent);
  --color-balance-accent-foreground: var(--balance-accent-foreground);
  --color-balance-foreground: var(--balance-foreground);
  --color-balance-value: var(--balance-value);
  
  --color-border: var(--border);
  --color-border-accent: var(--border-accent);
  --color-input: var(--input);
}

/* 3. Variables CSS (Paleta Personalizada) */
:root {
  /* BASE LIGHT - Fondo más cálido y acogedor */
  --background: #faf9f7;
  --foreground: #1f1f1f;

  /* CARDS - Blanco con sutil tono cálido */
  --card: #ffffff;
  --card-foreground: #1f1f1f;
  
  /* MUTED - Grises más cálidos */
  --muted: #f5f4f1;
  --muted-foreground: #6b6b6b;

  /* PRIMARY - Morado vibrante */
  --primary: #7c3aed;
  --primary-foreground: #ffffff;

  /* SUCCESS (Verde) */
  --success: #059669;
  --success-muted: #ecfdf5;

  /* DESTRUCTIVE (Rojo) */
  --destructive: #dc2626;
  --destructive-muted: #fef2f2;

  /* WARNING (Amarillo/Naranja) */
  --warning: #d97706;
  --warning-muted: #fffbeb;

  /* INFO (Azul) */
  --info: #2563eb;
  --info-muted: #eff6ff;

  /* BALANCE (Morado especial - más vibrante) */
  --balance-accent: #f3e8ff;
  --balance-accent-foreground: #7c3aed;
  --balance-foreground: #6b21a8;
  --balance-value: #7c3aed;

  /* BORDERS & INPUTS - Bordes más suaves */
  --border: #e5e5e5;
  --border-accent: #ddd6fe;
  --input: #ffffff;
  
  /* SOMBRAS para modo claro */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.05);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.05);
}

.dark {
  /* BASE DARK */
  --background: #0a0a0a;
  --foreground: #ededed;

  /* CARDS DARK */
  --card: #1f2937;
  --card-foreground: #ededed;

  /* MUTED DARK */
  --muted: #262626;
  --muted-foreground: #a3a3a3;

  /* PRIMARY DARK */
  --primary: #8b5cf6;
  --primary-foreground: #ffffff;

  /* SUCCESS DARK */
  --success: #10b981;
  --success-muted: #064e3b;

  /* DESTRUCTIVE DARK */
  --destructive: #ef4444;
  --destructive-muted: #7f1d1d;

  /* WARNING DARK */
  --warning: #f59e0b;
  --warning-muted: #78350f;

  /* INFO DARK */
  --info: #3b82f6;
  --info-muted: #1e3a8a;

  /* BALANCE DARK */
  --balance-accent: #581c87;
  --balance-accent-foreground: #c4b5fd;
  --balance-foreground: #d8b4fe;
  --balance-value: #c4b5fd;

  /* BORDERS & INPUTS DARK */
  --border: #4c1d95;
  --border-accent: #6d28d9;
  --input: #1f2937;
  
  /* SOMBRAS para modo oscuro */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.3);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.5), 0 4px 6px -4px rgb(0 0 0 / 0.4);
}

/* 4. Estilos Globales Base */
body {
  background-color: var(--background);
  color: var(--foreground);
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* 5. Componentes con Variables Nativas */
@layer components {
  .card-balance {
    @apply p-6 rounded-xl border transition-all;
    background: linear-gradient(135deg, #f3e8ff 0%, #ede9fe 50%, #e9d5ff 100%);
    border-color: var(--border-accent);
    box-shadow: 0 4px 6px -1px rgba(124, 58, 237, 0.08), 0 2px 4px -1px rgba(124, 58, 237, 0.04);
  }
  
  .dark .card-balance {
    background: var(--balance-accent);
  }

  .card-stat {
    @apply p-6 rounded-xl border transition-all;
    background-color: var(--card);
    border-color: var(--border);
    box-shadow: var(--shadow-md);
  }
  
  .card-stat:hover {
    box-shadow: var(--shadow-lg);
    border-color: var(--border-accent);
  }

  .card {
    @apply rounded-xl p-6 border transition-colors;
    background-color: var(--card);
    color: var(--card-foreground);
    border-color: var(--border);
    box-shadow: var(--shadow-md);
  }

  .form-container {
    @apply rounded-xl p-5 border;
    background-color: var(--card);
    border-color: var(--border);
    box-shadow: var(--shadow-sm);
  }

  .input-base {
    @apply w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all;
    background-color: var(--input);
    color: var(--foreground);
    border-color: var(--border);
    /* Mejoras para móvil: tamaño mínimo táctil y prevención de zoom en iOS */
    min-height: 44px;
    font-size: 16px; /* Previene zoom en iOS al enfocar */
  }

  @media (min-width: 640px) {
    .input-base {
      font-size: 14px; /* En desktop puede ser más pequeño */
      min-height: 42px;
    }
  }

  .input-base:hover {
    border-color: var(--border-accent);
  }

  /* Estilos específicos para selects */
  select.input-base {
    cursor: pointer;
    padding-right: 2.5rem; /* Espacio para la flecha */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.75rem center;
    background-repeat: no-repeat;
    background-size: 1.25em 1.25em;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }

  .dark select.input-base {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  }

  .label-base {
    @apply block mb-1.5 text-sm font-medium;
    color: var(--muted-foreground);
  }

  .icon-badge {
    @apply p-2 rounded-lg;
  }

  .btn-type {
    @apply flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all border;
  }

  .btn-type-inactive {
    background-color: var(--muted);
    color: var(--muted-foreground);
    border-color: var(--border);
  }
  
  .btn-type-inactive:hover {
    background-color: #eeede9;
    border-color: var(--border-accent);
  }

  .btn-type-active-destructive {
    background-color: var(--destructive-muted);
    color: var(--destructive);
    border-color: var(--destructive);
    box-shadow: 0 0 0 1px var(--destructive);
  }

  .btn-type-active-success {
    background-color: var(--success-muted);
    color: var(--success);
    border-color: var(--success);
    box-shadow: 0 0 0 1px var(--success);
  }

  .btn-type-active-info {
    background-color: var(--info-muted);
    color: var(--info);
    border-color: var(--info);
    box-shadow: 0 0 0 1px var(--info);
  }

  .btn-primary {
    @apply flex items-center justify-center gap-2 px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg font-medium shadow-md hover:shadow-lg transition-all text-sm sm:text-base min-h-[40px] sm:min-h-[44px];
    background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%);
    color: var(--primary-foreground);
  }
  
  .btn-primary:hover {
    background: linear-gradient(135deg, #6d28d9 0%, #7c3aed 100%);
    transform: translateY(-1px);
  }

  .btn-secondary {
    @apply flex items-center justify-center gap-2 px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg font-medium shadow-md hover:shadow-lg transition-all text-sm sm:text-base min-h-[40px] sm:min-h-[44px];
    background-color: var(--primary);
    color: var(--primary-foreground);
  }

  .btn-cancel {
    @apply flex items-center justify-center px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg font-medium transition-colors text-sm sm:text-base min-h-[40px] sm:min-h-[44px];
    background-color: var(--muted);
    color: var(--muted-foreground);
  }
  
  .btn-cancel:hover {
    background-color: #e5e4e0;
  }

  .btn-submit {
    @apply flex items-center justify-center px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg font-medium transition-all shadow-md text-sm sm:text-base min-h-[40px] sm:min-h-[44px];
    background-color: var(--primary);
    color: var(--primary-foreground);
  }
  
  .btn-submit:hover {
    background-color: #6d28d9;
    transform: translateY(-1px);
  }

  .btn-edit {
    @apply flex items-center justify-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors min-h-[36px];
    background-color: var(--info-muted);
    color: var(--info);
  }

  .btn-danger {
    @apply flex items-center justify-center gap-1 px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg text-sm sm:text-base font-medium transition-colors min-h-[40px] sm:min-h-[44px];
    background-color: #dc2626;
    color: white;
  }

  .btn-danger:hover {
    background-color: #b91c1c;
  }

  .btn-danger:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  .select-filter {
    @apply px-4 py-2.5 border rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent shadow-sm transition-all cursor-pointer;
    background-color: var(--input);
    color: var(--foreground);
    border-color: var(--border);
    min-height: 44px;
  }

  .select-filter:hover {
    border-color: var(--border-accent);
  }
}

/* ♿ MEJORAS DE ACCESIBILIDAD */

/* Clase para elementos solo visibles para screen readers */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Focus visible mejorado para accesibilidad */
*:focus-visible {
  outline: 2px solid theme('colors.purple.500');
  outline-offset: 2px;
  border-radius: 4px;
}

.dark *:focus-visible {
  outline-color: theme('colors.purple.400');
}
